<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Data-Driven Stochastic Closure Modeling via Conditional Diffusion Model and Neural Operator | Xinghao Dong </title> <meta name="author" content="Xinghao Dong"> <meta name="description" content="We propose a novel framework that leverages state-of-the-art machine learning techniques to construct stochastic closure models. Our approach combines conditional diffusion models with the Fourier Neural Operator (FNO) to capture the missing dynamics in complex systems governed by partial differential equations (PDEs)."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%A6%E2%80%8D%F0%9F%94%A5&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://xdong99.github.io//blog/2025/SBMFNO/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Data-Driven Stochastic Closure Modeling via Conditional Diffusion Model and Neural Operator",
            "description": "We propose a novel framework that leverages state-of-the-art machine learning techniques to construct stochastic closure models. Our approach combines conditional diffusion models with the Fourier Neural Operator (FNO) to capture the missing dynamics in complex systems governed by partial differential equations (PDEs).",
            "published": "March 01, 2025",
            "authors": [
              
              {
                "author": "Xinghao Dong",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "University of Wisconsin-Madison",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Xinghao Dong </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/CV/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">People </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Data-Driven Stochastic Closure Modeling via Conditional Diffusion Model and Neural Operator</h1> <p>We propose a novel framework that leverages state-of-the-art machine learning techniques to construct stochastic closure models. Our approach combines conditional diffusion models with the Fourier Neural Operator (FNO) to capture the missing dynamics in complex systems governed by partial differential equations (PDEs).</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#introduction"> Introduction </a></div> <div><a href="#closure-in-complex-dynamical-systems">Closure in Complex Dynamical Systems</a></div> <div><a href="#conditional-diffusion-model-framework">Conditional Diffusion Model Framework</a></div> <div><a href="#leveraging-fourier-neural-operators">Leveraging Fourier Neural Operators</a></div> </nav> </d-contents> <h2 id="introduction">Introduction</h2> <p>Closure models are widely used in simulating complex multiscale dynamical systems such as turbulence and the earth system, for which direct numerical simulation that resolves all scales is often too expensive. For those systems without a clear scale separation, deterministic and local closure models usually lack enough generalization capability, which limits their performance in many real-world applications. In this work, we propose a data-driven modeling framework for constructing stochastic and non-local closure models via conditional diffusion model and neural operator. Specifically, the Fourier neural operator is incorporated into a score-based diffusion model, which serves as a data-driven stochastic closure model for complex dynamical systems governed by partial differential equations (PDEs). We also demonstrate how accelerated sampling methods can improve the efficiency of the data-driven stochastic closure model. The results show that the proposed methodology provides a systematic approach via generative machine learning techniques to construct data-driven stochastic closure models for multiscale dynamical systems with continuous spatiotemporal fields.</p> <h2 id="closure-in-complex-dynamical-systems">Closure in Complex Dynamical Systems</h2> <p>Consider a dynamical system whose general governing equation is given by: \(\begin{equation} \label{eqn:true_system} \frac{\partial v}{\partial t} = M(v), \end{equation}\) where \(v\) represents the full system state and \(M\) encompasses the dynamics derived from first principles, which can include highly nonlinear mappings, differential operators, and integral operators. In practice, resolving every detail of \(v\) numerically is often impractical, which motivates the use of a reduced-order system: \(\begin{equation} \label{eqn:model_system} \frac{\partial V}{\partial t} = \widetilde{M}(V), \end{equation}\) with \(V := \mathcal{K}(v)\) denoting a reduced-order representation of \(v\), where the mapping \(\mathcal{K}\) extracts the essential information for numerical simulation. Here, \(\widetilde{M}(V)\) is constructed based on domain knowledge to approximate the reduced dynamics \(\mathcal{K} \circ M(v)\), resulting in a closed system in terms of \(V\) that is tractable for practical computations.</p> <p>To enhance the performance of traditional closure models \(\widetilde{M}\), researchers have recently introduced a machine-learning-based correction term \(U\), aiming for the modified model \(\widetilde{M}(V) + U\) to more accurately capture the true reduced-order dynamics.</p> <h2 id="conditional-diffusion-model-framework">Conditional Diffusion Model Framework</h2> <p>In this work, we focus on a stochastic variant of the correction term \(U\), enabled by recent advances in diffusion models. Diffusion models gradually add noise to data via a forward process, then learn to reverse the process to generate samples that mimic the original data distribution. In this work, we use the score-based diffusion model, which learns the gradient of the log probability density (the “score”) rather than the probability density itself. This formulation bypasses the need for a normalizing constant and makes the training process more tractable <d-cite key="song2020score"></d-cite>. Specifically, our goal is to approximate the distribution \(p(U)\) and to sample from it efficiently. It is important to note that \(U\) often depends on the current state \(V\) as well as additional information—such as the temporal history of \(V\) or spatially non-local data. Hence, we denote all such auxiliary information by \(\mathrm{y}\) and concentrate on a conditional diffusion model framework targeting the approximation and efficient sampling of \(p(U \mid \mathrm{y})\). By adopting this stochastic viewpoint, the model can naturally account for the uncertainty and variability inherent in unresolved scales. This probabilistic treatment is also especially important in systems where past states influence current dynamics—a phenomenon known as non-Markovian behavior.</p> <div class="row mt-3"> <div class="col-12 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2025-03-01-SBMFNO/Schematic-480.webp 480w,/assets/img/posts/2025-03-01-SBMFNO/Schematic-800.webp 800w,/assets/img/posts/2025-03-01-SBMFNO/Schematic-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/posts/2025-03-01-SBMFNO/Schematic.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Figure 1. Schematic plot of the entire workflow. <br> </div> </div> </div> <h2 id="leveraging-fourier-neural-operators">Leveraging Fourier Neural Operators</h2> <p>One of the major innovations in this work is the incorporation of Fourier Neural Operators (FNOs) to build the score function. Unlike traditional neural networks that operate on discretized data, FNOs work directly with continuous spatiotemporal fields. This confers two major advantages:</p> <ol> <li> <p><strong>Resolution Invariance:</strong> FNOs allow the model to generalize across different grid resolutions. This is particularly useful when training data might be available at one resolution while simulations require finer scales</p> </li> <li> <p><strong>Non-Local Modeling:</strong> Because FNOs operate in the Fourier domain, they inherently capture global interactions within the field. This makes them well-suited to model non-local effects, which are critical when the closure term depends on long-range interactions in the system.</p> </li> </ol> <p>The neural operator architecture seamlessly integrates multiple data inputs—such as the current vorticity field and sparse measurements of the true closure term—into the score-based diffusion framework.</p> <h2 id="more-to-come">More to come.</h2> <div class="row mt-3"> <div class="col-12 mt-3 mt-md-0"> <figure> <video src="/assets/video/Animation3050WithAndWithoutG.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" loop="" muted="" controls=""> <source src="" type="video/mp4"></source> Your browser does not support the video tag. /&gt; &lt;/figure&gt; <div class="caption"> Animations of the true vorticity field, and the simulation vorticity with and without G from 30s to 50s. <br> </div> &lt;/div&gt; &lt;/div&gt; </video></figure> </div> </div> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/blog1.bib"></d-bibliography> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Xinghao Dong. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: April 17, 2025. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>